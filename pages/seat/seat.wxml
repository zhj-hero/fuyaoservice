<!--pages/seat/seat.wxml-->
<view class="container">
  <view class="filter-bar">
    <view class="search-box">
      <input type="text" placeholder="以关键字搜索座位号，如：'A','1'等" bindinput="onSearchInput" />
    </view>

    
    <view class="filter-options">
      <picker bindchange="onFilterChange" value="{{filterIndex}}" range="{{filterOptions}}">
        <view class="filter-picker">
          <text>{{filterOptions[filterIndex]}}</text>
          <image class="down-icon" src="/static/images/down.png"></image>
        </view>
      </picker>
    </view>
  </view>

  <view class="seat-status-container">
    <view class="seat-status-header">
      <view class="seat-status-title">座位状态</view>
      <view class="seat-legend">
        <view class="legend-item">
          <view class="legend-color available"></view>
          <text>空闲</text>
        </view>
        <view class="legend-item">
          <view class="legend-color occupied"></view>
          <text>已占用</text>
        </view>
      </view>
    </view>
    
  </view>

  <view class="seat-list">
    <view class="section-title">座位列表</view>
    <view class="area-buttons">
      <view class="button-row">
        <button class="area-button" bindtap="filterByArea" data-area="A">A区</button>
        <button class="area-button" bindtap="filterByArea" data-area="B">B区</button>
        <button class="area-button" bindtap="filterByArea" data-area="C">C区</button>
        <button class="area-button" bindtap="filterByArea" data-area="D">D区</button>
      </view>
    </view>
  </view>

  <view class="filtered-results">
    <view class="section-title">筛选结果</view>
    <view class="seat-item" wx:for="{{filteredSeats}}" wx:key="seatId" bindtap="onSeatItemTap" data-seat="{{item}}">
      <view class="seat-info">
        <view class="seat-number">{{item.seatNumber}}</view>
        <view class="seat-type">{{item.type}}</view>
      </view>
      <view class="seat-status {{item.status}}">
        <text>{{item.statusText}}</text>
      </view>
    </view>
    <view class="no-data" wx:if="{{!filteredSeats.length}}">
      <text>暂无座位数据</text>
    </view>
  </view>


</view>

<!-- 座位详情弹窗 -->
<view class="seat-detail-modal" wx:if="{{showSeatDetail}}">
  <view class="modal-mask" bindtap="closeSeatDetail"></view>
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">座位详情</text>
    </view>
    <view class="modal-body">
      <view class="detail-item">
        <text class="detail-label">座位号：</text>
        <text class="detail-value">{{selectedSeat.seatNumber}}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">类型：</text>
        <text class="detail-value">{{selectedSeat.type}}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">状态：</text>
        <text class="detail-value {{selectedSeat.status}}">{{selectedSeat.statusText}}</text>
      </view>
    </view>
    <view class="modal-footer">
      <view class="modal-btn btn-cancel" bindtap="closeSeatDetail">关闭</view>
      <view class="modal-btn btn-book" bindtap="bookSeat" wx:if="{{selectedSeat.status === 'available'}}">预订座位</view>
      <view class="modal-btn btn-manage" bindtap="manageSeat" wx:if="{{isAdmin}}">管理座位</view>
    </view>
  </view>
</view>