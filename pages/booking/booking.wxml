<!--pages/booking/booking.wxml-->
<view class="container">
  
  
  <!-- 座位信息卡片 -->
  <view class="seat-info-card" wx:if="{{seatInfo}}">
    <view class="card-header">
      <view class="seat-info-title">
        <view class="seat-number">{{seatInfo.seatNumber}}</view>
        <view class="seat-status {{seatInfo.status}}">{{seatInfo.statusText}}</view>
      </view>
      <view class="change-seat" bindtap="openSeatSelector">更换座位</view>
    </view>
    <view class="card-body">
      <view class="info-item">
        <text class="label">类型：</text>
        <text class="value">{{seatInfo.type}}</text>
      </view>
      <view class="info-item" wx:if="{{seatInfo.features && seatInfo.features.length}}">
        <text class="label">设施：</text>
        <text class="value">{{seatInfo.features.join('、')}}</text>
      </view>
      <view class="info-item" wx:if="{{seatInfo.description}}">
        <text class="label">描述：</text>
        <text class="value">{{seatInfo.description}}</text>
      </view>
    </view>
  </view>

  <!-- 预订表单 -->
  <view class="booking-form">
    <view class="form-title">预订信息</view>
    
    <!-- 日期选择 -->
    <view class="form-group">
      <view class="form-label">日期</view>
      <picker mode="date" value="{{date}}" start="{{today}}" end="{{tomorrow}}" bindchange="bindDateChange">
        <view class="picker">
          <text>{{date}}</text>
          <image class="picker-arrow" src="/static/images/down.png"></image>
        </view>
      </picker>
    </view>
    
    <!-- 时间选择 -->
    <view class="form-row">
      <view class="form-group half">
        <view class="form-label">开始时间</view>
        <picker mode="selector" range="{{startTimeArray}}" value="0" bindchange="bindStartTimeChange">
          <view class="picker">
            <text>{{startTime}}</text>
            <image class="picker-arrow" src="/static/images/down.png"></image>
          </view>
        </picker>
      </view>
      
      <view class="form-group half">
        <view class="form-label">结束时间</view>
        <picker mode="selector" range="{{endTimeArray}}" value="0" bindchange="bindEndTimeChange">
          <view class="picker">
            <text>{{endTime}}</text>
            <image class="picker-arrow" src="/static/images/down.png"></image>
          </view>
        </picker>
      </view>
    </view>
    
    <!-- 用途输入 -->
    <view class="form-group">
      <view class="form-label">使用用途 <text class="required">*</text></view>
      <input class="form-input" placeholder="请输入使用用途" value="{{purpose}}" bindinput="inputPurpose" />
    </view>
    
    <!-- 备注输入 -->
    <view class="form-group">
      <view class="form-label">备注</view>
      <textarea class="form-textarea" placeholder="请输入备注信息（选填）" value="{{remark}}" bindinput="inputRemark"></textarea>
    </view>
  </view>
  
  <!-- 按钮区域 -->
  <view class="btn-group">
    <button class="btn-cancel" bindtap="cancelBooking">取消</button>
    <button class="btn-submit" bindtap="submitBooking">提交预订</button>
  </view>
</view>

<!-- 座位选择器弹窗 -->
<view class="seat-selector-modal" wx:if="{{showSeatSelector}}">
  <view class="modal-mask" bindtap="closeSeatSelector"></view>
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">选择座位</text>
      <view class="modal-close" bindtap="closeSeatSelector">×</view>
    </view>
    <view class="modal-body">
      <view class="seat-list">
        <view class="seat-item" wx:for="{{availableSeats}}" wx:key="_id" bindtap="selectSeat" data-id="{{item._id}}">
          <view class="seat-info">
            <view class="seat-number">{{item.seatNumber}}</view>
            <view class="seat-type">{{item.type}}</view>
          </view>
          <view class="seat-status {{item.status}}">
            <text>{{item.statusText}}</text>
          </view>
        </view>
        <view class="no-data" wx:if="{{!availableSeats.length}}">
          <text>暂无可用座位</text>
        </view>
      </view>
    </view>
  </view>
</view>